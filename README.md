# Vulnerability Scanner

This is a university project vulnerability scanner consisting of worker and leader agents. The scanner is designed to inspect a given directory for potential security vulnerabilities, such as exposed secrets or keys.

## Usage
Firstly, install the project dependencies by running
```bash
pip install -r requirements.txt
```

To run the vulnerability scanner, execute the following command in the terminal:

```bash
python app/main.py --agents=3 --dir="./sample-dir"
```

- `--agents`: Number of agents to be created, where one is assigned as a leader and the others are workers which perform the scanning. Must be at least `2`.
- `--dir`: Path to the directory where the vulnerability scanning should take place.

## How it Works

The specified number of agents are initalised, each with a 300ms gap to prevent race conditions. The agents all run in separate, parallel threads.
There are two agent types: leaders and workers. The leader is responsible for: 
- setting up the scanning environment, 
- ensuring the workers are active
- and generating a report once the scanning is complete.

The workers are responsible for:
- scanning the files and identifying if they contain any vulnerabilities
- keeping track of their activities in a log file

### Leader Agent Procedure
1. Initiate the scanning environment by creating:
    - a folder to contain the process info in,
    - a quarantine directory for containing quarantined files,
    - a file containing the paths of all files to be scanned for vulnerabilities.
2. Regularly check worker log files to ensure they are not hung up.
    - If a worker has hung up, terminate it and record the file it was hung up on. This file will be included in the final report to ensure the user is aware it was not propely scanned.
3. Once all workers have been terminated, generate a report and report summary.

### Worker Agent Procedure
1. Initiate a log file to keep track of all its activities
2. Get a file path for scanning from the file path list generated by the leader
    - if the file path list has a lock on it, wait 30ms and try again
    - if the file path list can be accessed get the file path from the first line, delete it from the file and close it
3. Open the file at the extracted file path and  asses it
 - check if has an extension that is commonly associated with holding keys or secrets. If so flag it as quarantine level 'RED' and move to quarantine
 - if not, then check if it contains potential keys or secrets by checking for long strings, hex strings, uuids or base64 string. If so flag it as quarantine level 'AMBER' and move to quarantine
 - otherwise, marke the file as 'SAFE' 
4. After completing each scan, update the total for the leaders report
5. Repeat the process until the file list path file is empty. If so, then terminate the worker